我将为您实施一套**全站统一的高级 Markdown 渲染方案**，彻底解决包括排版、公式、代码、表格及结构树在内的所有显示问题。

**问题根源分析**：
当前系统中的 Markdown 渲染逻辑分散在多个组件中，且**缺少核心的排版插件 (`@tailwindcss/typography`)**。这导致了：
1.  **基础样式缺失**：标题、列表、段落间距等没有默认样式，看起来像纯文本。
2.  **高级功能不全**：表格、数学公式、代码高亮在不同页面表现不一致，甚至无法渲染。
3.  **维护困难**：修复了一个页面，另一个页面依然有问题。

**实施方案**：

1.  **引入专业排版引擎**：
    *   安装并配置 `@tailwindcss/typography`：这是 Tailwind 官方的排版插件，能自动为 Markdown 内容提供优雅的阅读体验（类似 GitHub 或 Notion 的渲染效果）。
    *   安装 `react-syntax-highlighter`：提供专业的代码块语法高亮。

2.  **构建统一渲染组件 (`MarkdownRenderer`)**：
    *   创建一个全新的通用组件，集成所有必要的插件：
        *   `remark-gfm`: 完美支持表格、删除线、自动链接。
        *   `remark-math` & `rehype-katex`: 完美渲染数学公式。
        *   `remark-breaks`: 支持硬换行。
    *   **深度定制样式**：
        *   **表格**：仿 Ant Design 风格，增加边框、斑马纹和悬停效果。
        *   **代码/结构树**：使用 Prism 风格高亮，支持复制功能，完美展示 ASCII 知识树。
        *   **标题与排版**：优化行高、字号和间距，确保层次分明。

3.  **全站替换与升级**：
    *   扫描并替换系统中所有旧的 `ReactMarkdown` 使用点（包括 AI 对话、学习历史、复习界面等）。
    *   废弃不一致的旧渲染逻辑。

**执行步骤**：
1.  安装依赖 (`typography`, `syntax-highlighter`)。
2.  配置 `tailwind.config.ts`。
3.  开发 `app/components/MarkdownRenderer.tsx`。
4.  逐个替换现有页面中的渲染组件。

完成后，您的系统将拥有统一、美观且功能强大的文档渲染能力。